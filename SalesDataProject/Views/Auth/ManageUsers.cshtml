@model IEnumerable<SalesDataProject.Models.AuthenticationModels.User>

@{
    var userList = Model.ToList();
}
@{
    ViewData["Title"] = "Manage Users";
}
<div class="container">
    <div class="header d-flex justify-content-between align-items-center p-3 rounded shadow" style="background: linear-gradient(135deg, #4A90E2, #001F3F);">
        <h2 class="text-white fw-bold m-0">Manage Users Permissions</h2>
        <div class="d-flex gap-2">
            <form asp-action="AddRecord" method="get">
                <button type="submit" class="btn btn-outline-light fw-bold">➕ Add Record</button>
            </form>
            <form asp-action="AssignRecords" method="get">
                <button type="submit" class="btn btn-primary fw-bold">🎯 Assign Record</button>
            </form>
            <form asp-action="ChangeRecordType" method="get">
                <button type="submit" class="btn btn-warning fw-bold">🔄 Change Record</button>
            </form>
            <form asp-action="CreateUser" method="get">
                <button type="submit" class="btn btn-danger fw-bold">👤 Create User</button>
            </form>
            <a href="@Url.Action("Index", "Home")">
                <button type="button" class="btn btn-dark fw-bold">🔙 Back</button>
            </a>
        </div>
    </div>

    <form asp-action="UpdateUserAccess" method="post">
        <div class="table-responsive mt-4">
            <table class="table table-bordered table-hover">
                <thead class="table-dark text-center">
                    <tr>
                        <th>Username</th>
                        <th>Customer Module</th>
                        <th>Mailing Data Module</th>
                        <th>User Management</th>
                        <th>Title Module</th>
                        <th>View Titles</th>
                        <th>Delete Titles</th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < userList.Count; i++)
                    {
                        <tr>
                            <td class="align-middle fw-bold text-center">
                                @userList[i].Username
                                <input type="hidden" name="Users[@i].Username" value="@userList[i].Username" />
                            </td>
                            @foreach (var property in new[] { "CanAccessCustomer", "CanAccessSales", "CanAccessUserManagement", "CanAccessTitle", "CanViewTitles", "CanDeleteTitles" })
                            {
                                <td class="text-center align-middle">
                                    <input type="checkbox" name="Users[@i].@property"
                                           value="true" @(userList[i].GetType().GetProperty(property).GetValue(userList[i]) as bool? == true ? "checked" : "")
                                           class="form-check-input mx-auto" />
                                    <input type="hidden" name="Users[@i].@property" value="false" />
                                </td>
                            }
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <div class="text-center mt-4">
            <button type="submit" class="btn btn-success btn-lg fw-bold shadow">✅ Update Access</button>
        </div>
    </form>
</div>

<style>
    h2 {
        font-size: 1.6rem;
        font-weight: 600;
        color: #333;
        text-align: center;
    }

    .container {
        background-color: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }

    table {
        width: 100%;
        border-collapse: collapse;
        border-radius: 8px;
        overflow: hidden;
    }

    th, td {
        padding: 10px 12px;
        text-align: center;
    }

    th {
        background-color: #212529;
        color: white;
        font-size: 0.95rem;
        font-weight: 600;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f1f1f1;
    }

    .table-striped tbody tr:nth-of-type(even) {
        background-color: #ffffff;
    }

    .table-striped tbody tr:hover {
        background-color: #e0e0e0;
    }

    td input[type="checkbox"] {
        transform: scale(1.1);
    }

    .btn {
        font-size: 0.875rem;
        font-weight: 500;
        padding: 8px 12px;
    }

    .btn-dark {
        background-color: #343a40;
        border-color: #343a40;
    }

        .btn-dark:hover {
            background-color: #23272b;
        }

    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
    }

        .btn-primary:hover {
            background-color: #0056b3;
        }

    .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
    }

        .btn-danger:hover {
            background-color: #c82333;
        }

    .btn-warning {
        background-color: #ffc107;
        border-color: #ffc107;
        color: black;
    }

        .btn-warning:hover {
            background-color: #e0a800;
        }

    .text-center {
        text-align: center;
    }

    .text-end {
        text-align: right;
    }

    .header {
        margin-bottom: 15px;
    }
</style>

